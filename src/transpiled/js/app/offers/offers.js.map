{"version":3,"sources":["../../../../js/app/offers/offers.js"],"names":[],"mappings":"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","file":"offers.js","sourcesContent":["\"use strict\";\n\napp.controller(\"OffersCtrl\", [\"$scope\", \"$rootScope\", \"$http\", \"$mdToast\", \"Offer\", \"$filter\",\n  function(                    $scope,   $rootScope,   $http,   $mdToast,   Offer,   $filter) {\n\n    /**\n     * get Dexie dbCore\n     *\n     */\n    let dbCore = $rootScope.dbCore;\n    /**\n     * get merchantMe and merchantToken from Locker\n     *\n     */\n    let merchantMe    = locker.driver(\"local\").namespace(\"core\").get(\"me\");\n    let merchantToken = locker.driver(\"local\").namespace(\"core\").get(\"merchantToken\");\n\n    let merchantOffers = $rootScope.allData.offers;\n      $scope.allOffers = {};\n      //$scope.allOffers.list = {};\n      $scope.allOffers.count = 0;\n\n      $scope.toggleWizardLoader = {\n          showLoader: false\n      }\n\n      $scope.toggleWizardLoader.showLoader = true;\n\n      Offer.OfferAllData(merchantToken).then(function() {\n          $scope.allOffers = Offer.getOfferAllData();\n          //$scope.allOffers.list = $scope.allOffers;\n          $scope.toggleWizardLoader.showLoader = false;\n      });\n\n    $scope.trashOffer = (index, oId) => {\n\n      let offerId = {\n        OfferId: oId,\n        MerchantToken: merchantToken\n      }\n\n      Offer.trash(offerId).then(response => {\n\n        let statusCode    = response.FlikResponse.Status.StatusCode;\n        let statusMessage = response.FlikResponse.Status.StatusMessage;\n\n        if (statusCode == 0) {\n\n          //merchantOffers.list.splice(index, 1);\n          //merchantOffers.count = merchantOffers.list.length;\n\n            $scope.allOffers.splice(index, 1);\n            //$scope.allOffers.count = $scope.allOffers.list.length;\n\n          $mdToast.show(\n            $mdToast.simple()\n              .content(\"offer deleted successfully\")\n              .position(\"top right\")\n              .hideDelay(2700)\n          );\n\n        } else if (statusCode == 1 && statusMessage == \"No record found\" ||\n          statusCode == 1 && statusMessage ==  \"Data in the request is either empty or of invalid format\") {\n\n          $mdToast.show(\n            $mdToast.simple()\n              .content(statusMessage)\n              .position(\"top right\")\n              .hideDelay(2700)\n          );\n\n        } else if (statusCode == 3) {\n\n          /**\n           * if we reach here merchantToken is no longer valid\n           * we boot user back to signin\n           *\n           * TODO: add modal to reauth without back to signin page\n           */\n          locker.driver(\"local\")\n            .namespace(\"core\")\n            .forget(\"merchantToken\");\n          $state.go(\"access.signin\");\n          console.group(\"and the status is \" + statusCode);\n          console.warn(response + \" token not valid - need to login again\");\n          console.info(\"bye -- see you soon\");\n          console.groupEnd();\n\n        } else {\n\n          $mdToast.show(\n            $mdToast.simple()\n              .content(statusMessage)\n              .position(\"top right\")\n              .hideDelay(2700)\n          );\n          console.warn(statusMessage + \" this is the status message\");\n\n        }\n      }, error => {\n\n        $mdToast.show(\n          $mdToast.simple()\n            .content(\"there was an error deleting offer please try again\")\n            .position(\"top right\")\n            .hideDelay(2700)\n        );\n        console.warn(error + \" this is the error from offer delete\");\n\n      });\n    }\n\n}]);\n"]}